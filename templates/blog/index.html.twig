{% extends 'base.html.twig' %}

{% block title %}Blog{% endblock %}

{% block body %}

    <body class="container-lg mt-5">

        <div class="row top-25 w-100"  style="border:solid 25px #229296;border-radius:50px;">

            <div class="col-12 col-lg-12 bg-light px-2 px-lg-5 py-0 my-0" style="border:solid 5px light;border-radius:25px;">

                {# <div class=""> #}
                    <h2 class="text-dark fs-2 fst-italic text-center mx-4"><strong>Nos dernières publications</strong></h2>
                {# </div> #}

                {# Affichage du nombre total de publications (attibut apporté par knp_paginator) #}
                <div class="col-12 ps-5">
                    <p class="fs-5 text-left text-dark">Nombre total d'articles : {{ posts_paginate.getTotalItemCount }}</p>
                </div>

                {# S'il y a des publications, on affiche le menu de pagination #}
                <div class="container">
                    <div class="fs-6 fst-italic text-center mx-4">
                        {{ knp_pagination_render(posts_paginate) }}
                    </div>
                </div>
                {### AFFICHAGE DES PUBLICATIONS ###}

                    {###### Boucle pour parcourir toutes les publications à afficher ######}
                    {% for post in posts_paginate %}

                    {# {{ dump(posts) }} #}

                    <div class="text-left p-2 mx-3 text-left">
                        <div class="col-12">

                            <div class="my-5" style="background-color:rgb(200, 250, 250, 0.5);">
                                <div class="fs-5 fst-italic" style="background-color:lightgrey;">
                                    {# Titre de la publication, cliquable vers la page détaillée de celle-ci #}
                                    <a class="text-decoration-none texte-title-h1" href="{{ path('app_blog_show_post', {'slug': post.slug}) }}">
                                        <i class="fa-solid fa-xl fa-newspaper pe-4"></i>{{ post.title }}
                                    </a>
                                </div>

                                <div class="fs-5">
                                    {# Affichage du contenu de la publication, tronquée à 600 caractères, suivi de "..." et d'un lien "lire la suite" #}
                                    {{ post.content|slice(0, 500) }} ...
                                    <a class="text-decoration-none text-title-h2" href="{{ path('app_blog_show_post', {'slug': post.slug}) }}">
                                    Lire la suite</a>
                                </div>

                                {# Date et auteur de la publication et de la modification si nécessaire #}
                                <div class="text-muted py-2">
                                    Publié le <span class="text-warning">{{ post.createdAt|date('d/M/Y à H\\hi') }}</span> par <span class="text-title-h2">
                                    {{ post.author.username }}</span>
                                    {% if post.updatedAt %}
                                        et modifié le <span class="text-warning">{{ post.updatedAt|date('d/M/Y à H\\hi') }}</span>
                                    {% endif %}
                                </div>
                            </div>
                        </div>
                    </div>

                {% else %}
                        <div class="row">
                            <p class="col-12 text-center alert alert-warning">Aucune publication à afficher.</p>
                        </div>
                {% endfor %}


                <div class="container">
                    <a href="{{ path('app_blog_new_post') }}" class="mx-4 px-5 py-2 text-light" style="font-size:2rem;background-color: #11494C;border:solid 5px dark;border-radius:25px;">
                    Creer un nouvel article</a>
                </div>

            </div>

        </div>

    </body>

{% endblock %}
